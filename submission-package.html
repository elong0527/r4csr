<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 14 Submission package | R for Clinical Study Reports and Submission</title>
<meta name="author" content="Yilong Zhang">
<meta name="author" content="Nan Xiao">
<meta name="author" content="Keaven Anderson">
<meta name="description" content="In this chapter, we will first give a high-level overview of what assets in the eCTD submission package we should focus on when submitting R code. Then, we will discuss how to prepare the...">
<meta name="generator" content="bookdown 0.31 with bs4_book()">
<meta property="og:title" content="Chapter 14 Submission package | R for Clinical Study Reports and Submission">
<meta property="og:type" content="book">
<meta property="og:description" content="In this chapter, we will first give a high-level overview of what assets in the eCTD submission package we should focus on when submitting R code. Then, we will discuss how to prepare the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 14 Submission package | R for Clinical Study Reports and Submission">
<meta name="twitter:description" content="In this chapter, we will first give a high-level overview of what assets in the eCTD submission package we should focus on when submitting R code. Then, we will discuss how to prepare the...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/table1-1.0/table1_defaults.css" rel="stylesheet">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-MKYDL3PNW1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-MKYDL3PNW1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Clinical Study Reports and Submission</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li class="book-part">Delivering TLFs in CSR</li>
<li><a class="" href="tlf-overview.html"><span class="header-section-number">1</span> Overview</a></li>
<li><a class="" href="disposition.html"><span class="header-section-number">2</span> Disposition</a></li>
<li><a class="" href="population.html"><span class="header-section-number">3</span> Analysis population</a></li>
<li><a class="" href="baseline-characteristics.html"><span class="header-section-number">4</span> Baseline characteristics</a></li>
<li><a class="" href="efficacy-table.html"><span class="header-section-number">5</span> Efficacy table</a></li>
<li><a class="" href="efficacy-figure.html"><span class="header-section-number">6</span> Efficacy figure</a></li>
<li><a class="" href="aesummary.html"><span class="header-section-number">7</span> AE summary</a></li>
<li><a class="" href="specific-ae.html"><span class="header-section-number">8</span> Specific AE</a></li>
<li><a class="" href="assemble.html"><span class="header-section-number">9</span> Assemble TLFs</a></li>
<li class="book-part">Clinical trial project</li>
<li><a class="" href="project-overview.html"><span class="header-section-number">10</span> Overview</a></li>
<li><a class="" href="folder.html"><span class="header-section-number">11</span> Project folder</a></li>
<li><a class="" href="manage.html"><span class="header-section-number">12</span> Project management</a></li>
<li class="book-part">eCTD submission</li>
<li><a class="" href="submission-overview.html"><span class="header-section-number">13</span> Overview</a></li>
<li><a class="active" href="submission-package.html"><span class="header-section-number">14</span> Submission package</a></li>
<li><a class="" href="running-environment.html"><span class="header-section-number">15</span> Running environment</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/elong0527/r4csr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="submission-package" class="section level1" number="14">
<h1>
<span class="header-section-number">14</span> Submission package<a class="anchor" aria-label="anchor" href="#submission-package"><i class="fas fa-link"></i></a>
</h1>
<p>In this chapter, we will first give a high-level overview of what
assets in the eCTD submission package we should focus on when
submitting R code.
Then, we will discuss how to prepare the proprietary R packages
(if any), and make them be part of the submission package.
In the end, we will provide reusable templates for updating
Analysis Data Reviewer’s Guide (ADRG) and Analysis Results Metadata (ARM)
so that the reviewers receive proper instructions to reproduce the
analysis results.</p>
<div id="prerequisites" class="section level2" number="14.1">
<h2>
<span class="header-section-number">14.1</span> Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"><i class="fas fa-link"></i></a>
</h2>
<p>This chapter uses <code>pkglite</code> to convert R source packages
into text files and back.</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pkglite"</span><span class="op">)</span></span></code></pre></div>
<p>The demo project (R package) we will prepare for submission is called
<a href="https://github.com/elong0527/esubdemo"><code>esubdemo</code></a>, which is available on GitHub.
You can download or clone it:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb133-1"><a href="submission-package.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/elong0527/esubdemo.git</span></code></pre></div>
<p>The demo submission package (not to be confused with the R package above)
is <a href="https://github.com/elong0527/ectddemo"><code>ectddemo</code></a>, which is also available on GitHub.
You can download or clone it:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb134-1"><a href="submission-package.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/elong0527/ectddemo.git</span></code></pre></div>
<p>We assume the paths to the two folders are <code>esubdemo/</code> and <code>ectddemo/</code> below.</p>
</div>
<div id="the-whole-game" class="section level2" number="14.2">
<h2>
<span class="header-section-number">14.2</span> The whole game<a class="anchor" aria-label="anchor" href="#the-whole-game"><i class="fas fa-link"></i></a>
</h2>
<p>In eCTD deliverable, the analysis datasets and source code are saved
under the eCTD module 5 (clinical study reports) folder</p>
<pre><code>ectddemo/m5/datasets/&lt;study&gt;/analysis/adam/</code></pre>
<p>The files in two directories within the <code>adam/</code> folder
are critical for documenting analysis using R: <code>datasets/</code> and <code>programs/</code>.</p>
<pre><code>ectddemo/m5/datasets/ectddemo/analysis/adam/
├── datasets
│   ├── adae.xpt
│   ├── ...
│   ├── adrg.pdf
│   ├── analysis-results-metadata.pdf
│   ├── define.xml
│   └── define2-0-0.xsl
└── programs
    ├── r0pkgs.txt
    ├── tlf-01-disposition.txt
    ├── tlf-02-population.txt
    ├── tlf-03-baseline.txt
    ├── tlf-04-efficacy.txt
    ├── tlf-05-ae-summary.txt
    └── tlf-06-ae-spec.txt</code></pre>
<p>The special considerations for each component are listed below.</p>
<div id="datasets-1" class="section level3" number="14.2.1">
<h3>
<span class="header-section-number">14.2.1</span> <code>datasets</code><a class="anchor" aria-label="anchor" href="#datasets-1"><i class="fas fa-link"></i></a>
</h3>
<p>Folder path: <code>ectddemo/m5/datasets/ectddemo/analysis/adam/datasets/</code>.</p>
<ul>
<li>ADaM data in <code>.xpt</code> format: created by SAS or R.</li>
<li>
<code>define.xml</code>: created by Pinnacle 21.</li>
<li>ADRG (Analysis Data Reviewer’s Guide)
<ul>
<li>“Macro Programs” section: provide R and R package versions with a snapshot date.</li>
<li>Appendix: provide step-by-step instructions for reviewers to
reproduce the running environment and rerun analyses.</li>
</ul>
</li>
<li>ARM (Analysis Results Metadata): provide the links between TLFs and
analysis programs in tables.</li>
</ul>
</div>
<div id="programs" class="section level3" number="14.2.2">
<h3>
<span class="header-section-number">14.2.2</span> <code>programs</code><a class="anchor" aria-label="anchor" href="#programs"><i class="fas fa-link"></i></a>
</h3>
<p>Folder path: <code>ectddemo/m5/datasets/ectddemo/analysis/adam/programs/</code>.</p>
<ul>
<li>
<code>r0pkgs.txt</code>: contains all internally developed proprietary R packages.</li>
<li>Other <code>.txt</code> files: each contains R code for a specific analysis.</li>
</ul>
</div>
<div id="notes" class="section level3" number="14.2.3">
<h3>
<span class="header-section-number">14.2.3</span> Notes<a class="anchor" aria-label="anchor" href="#notes"><i class="fas fa-link"></i></a>
</h3>
<p>To verify if the submission package works, rerun all analyses following the
instructions defined in ADRG.</p>
<p>A few things need to be paid attention to in order to pass compliance checks:</p>
<ul>
<li>The file names under <code>programs/</code> should be in lower case letters
(with no underscores or other special characters).</li>
<li>The <code>.txt</code> files should only contain ASCII characters.
This can be verified by <code><a href="https://merck.github.io/pkglite/reference/verify_ascii.html">pkglite::verify_ascii()</a></code>
</li>
<li>All <code>.docx</code> files should be converted to PDF files for formal submission.</li>
</ul>
<p>Now you have a general idea about the relevant components of the
submission package.
We will prepare the proprietary R packages in the following sections.</p>
</div>
</div>
<div id="practical-considerations-for-r-package-submissions" class="section level2" number="14.3">
<h2>
<span class="header-section-number">14.3</span> Practical considerations for R package submissions<a class="anchor" aria-label="anchor" href="#practical-considerations-for-r-package-submissions"><i class="fas fa-link"></i></a>
</h2>
<p>Before we start, there are a few aspects to figure out in order
to accurately identify the R packages for submission.</p>
<div id="source-location" class="section level3" number="14.3.1">
<h3>
<span class="header-section-number">14.3.1</span> Source location<a class="anchor" aria-label="anchor" href="#source-location"><i class="fas fa-link"></i></a>
</h3>
<p>There are a few common places to host R (source) packages:</p>
<ol style="list-style-type: decimal">
<li>CRAN</li>
<li>Public Git repository</li>
<li>Private Git repository (accessible externally)</li>
<li>Private Git repository (inaccessible externally)</li>
</ol>
<p>For R packages hosted on CRAN or a public Git repository,
you probably do not need to submit them as part of the submission package,
as the reviewers can install them directly by following the instructions in ADRG.</p>
<p>For R packages hosted in private repositories, to avoid any complications
in infrastructure, authentication, and communication, it is often
recommended to submit them as part of the submission package.</p>
</div>
<div id="dependency-locations" class="section level3" number="14.3.2">
<h3>
<span class="header-section-number">14.3.2</span> Dependency locations<a class="anchor" aria-label="anchor" href="#dependency-locations"><i class="fas fa-link"></i></a>
</h3>
<p>R package dependency is another major factor to consider
before preparing your proprietary R package for submission.</p>
<p>For dependencies available from CRAN or public Git repositories,
you can declare them directly using the regular <code>Imports</code> and <code>Suggests</code>
syntax or the
<a href="https://remotes.r-lib.org/articles/dependencies.html">remotes dependency syntax</a> in the <code>DESCRIPTION</code> file.</p>
<p>For dependencies hosted in private Git repositories, you should pack them
with the primary R package(s) you want to submit,
as <code>pkglite</code> supports packing multiple R packages into a single text file;
then restore and install them in the order they are packed.</p>
</div>
<div id="r-version-1" class="section level3" number="14.3.3">
<h3>
<span class="header-section-number">14.3.3</span> R version<a class="anchor" aria-label="anchor" href="#r-version-1"><i class="fas fa-link"></i></a>
</h3>
<p>Always use a consistent version of R for developing the TLFs and for submission.
For example, you could enforce a rule to only use R <code>x.y.z</code> where <code>z = 1</code>,
such as R <code>4.0.1</code> or R <code>4.1.1</code>.
This can be automatically checked using a
<a href="https://github.com/elong0527/esubdemo/blob/master/inst/startup.R">startup script</a> when the R project is opened.</p>
</div>
<div id="package-repo-version" class="section level3" number="14.3.4">
<h3>
<span class="header-section-number">14.3.4</span> Package repo version<a class="anchor" aria-label="anchor" href="#package-repo-version"><i class="fas fa-link"></i></a>
</h3>
<p>Always use the same snapshot package repo for developing the TLFs and for submission.
Again, this can be checked in the project startup script,
as discussed in section <a href="folder.html#reproduce">11.2</a>.</p>
</div>
<div id="system-environments" class="section level3" number="14.3.5">
<h3>
<span class="header-section-number">14.3.5</span> System environments<a class="anchor" aria-label="anchor" href="#system-environments"><i class="fas fa-link"></i></a>
</h3>
<p>Introducing any extra external dependencies will likely increase the cost
of qualification, validation, testing, and maintenance,
especially under Windows.
Therefore, it is recommended to keep the dependency chain simple,
especially when involving compiled code (e.g., C, C++, Fortran).</p>
</div>
</div>
<div id="prepare-r-packages-for-submission" class="section level2" number="14.4">
<h2>
<span class="header-section-number">14.4</span> Prepare R packages for submission<a class="anchor" aria-label="anchor" href="#prepare-r-packages-for-submission"><i class="fas fa-link"></i></a>
</h2>
<p>To prepare R packages for submission, one needs to pack the packages into text files, and then verify if the files only contain ASCII characters.
With packed packages, one can unpack and install them from the text files, too.</p>
<div id="pack" class="section level3" number="14.4.1">
<h3>
<span class="header-section-number">14.4.1</span> Pack<a class="anchor" aria-label="anchor" href="#pack"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s pack the <code>esubdemo</code> package into a text file.
Assume the source package path is <code>esubdemo/</code>.
You should be able to pack the package with a single pipe:</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://merck.github.io/pkglite/">"pkglite"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="st">"esubdemo/"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://merck.github.io/pkglite/reference/collate.html">collate</a></span><span class="op">(</span><span class="fu"><a href="https://merck.github.io/pkglite/reference/file_ectd.html">file_ectd</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://merck.github.io/pkglite/reference/file_auto.html">file_auto</a></span><span class="op">(</span><span class="st">"inst"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://merck.github.io/pkglite/reference/pack.html">pack</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"r0pkgs.txt"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-147"></span>
<img src="images/pack.png" alt="Output of pkglite::pack()" width="100%"><p class="caption">
FIGURE 14.1: Output of pkglite::pack()
</p>
</div>
<p>Let’s open the generated text file:</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/file.edit.html">file.edit</a></span><span class="op">(</span><span class="st">"r0pkgs.txt"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-149"></span>
<img src="images/preview-txt.png" alt="Preview the generated text file" width="100%"><p class="caption">
FIGURE 14.2: Preview the generated text file
</p>
</div>
<p>What happened in the pipe?
The function <code><a href="https://merck.github.io/pkglite/reference/collate.html">pkglite::collate()</a></code> evaluates a specified scope of
folders and files defined by a list of <strong>file specifications</strong>,
and generates a <strong>file collection</strong> object.
This file collection contains the metadata required to properly convert
the files into text which is then used by <code><a href="https://merck.github.io/pkglite/reference/pack.html">pkglite::pack()</a></code>.
With this flow, you can define the scope of the R source package
to be packed for submission in a flexible yet principled way.</p>
<p>To pack multiple R packages, simply feed multiple file collections as inputs:</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://merck.github.io/pkglite/reference/pack.html">pack</a></span><span class="op">(</span></span>
<span>  <span class="st">"/path/to/pkg1/"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://merck.github.io/pkglite/reference/collate.html">collate</a></span><span class="op">(</span><span class="fu"><a href="https://merck.github.io/pkglite/reference/file_ectd.html">file_ectd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"/path/to/pkg2/"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://merck.github.io/pkglite/reference/collate.html">collate</a></span><span class="op">(</span><span class="fu"><a href="https://merck.github.io/pkglite/reference/file_ectd.html">file_ectd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  output <span class="op">=</span> <span class="st">"r0pkgs.txt"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The R packages are always packed in the specified order and are always
unpacked and installed in the same order. Therefore, make sure to
pack the low-level dependencies first.</p>
<p>For more details on how to customize file specifications
and operate on file collections,
check out the vignette
<a href="https://merck.github.io/pkglite/articles/filespec.html">generate file specifications</a>
and
<a href="https://merck.github.io/pkglite/articles/filecollection.html">curate file collections</a>.</p>
</div>
<div id="verify" class="section level3" number="14.4.2">
<h3>
<span class="header-section-number">14.4.2</span> Verify<a class="anchor" aria-label="anchor" href="#verify"><i class="fas fa-link"></i></a>
</h3>
<p>You should always verify if the text file only contains ASCII characters:</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://merck.github.io/pkglite/reference/verify_ascii.html">verify_ascii</a></span><span class="op">(</span><span class="st">"r0pkgs.txt"</span><span class="op">)</span></span></code></pre></div>
<p>This should give <code>TRUE</code> if the file only contains ASCII characters,
or <code>FALSE</code> with the affected lines otherwise.</p>
</div>
<div id="unpack" class="section level3" number="14.4.3">
<h3>
<span class="header-section-number">14.4.3</span> Unpack<a class="anchor" aria-label="anchor" href="#unpack"><i class="fas fa-link"></i></a>
</h3>
<p>One can unpack and install the package from the text file, too.
For example:</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://merck.github.io/pkglite/reference/unpack.html">unpack</a></span><span class="op">(</span><span class="st">"r0pkgs.txt"</span>, output <span class="op">=</span> <span class="st">"/tmp/"</span>, install <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>If the test is successful, this command can be used in the ADRG instructions
for restoring and installing the packed R package(s).</p>
<p>You can then proceed to move the file <code>r0pkgs.txt</code> to the folder
<code>ectddemo/m5/datasets/ectddemo/analysis/adam/programs/</code>,
or specify the output text file path above directly.</p>
</div>
</div>
<div id="prepare-analysis-programs-for-submission" class="section level2" number="14.5">
<h2>
<span class="header-section-number">14.5</span> Prepare analysis programs for submission<a class="anchor" aria-label="anchor" href="#prepare-analysis-programs-for-submission"><i class="fas fa-link"></i></a>
</h2>
<p>Besides the R packages, we need to convert the R Markdown (<code>.Rmd</code>) files
into <code>.txt</code> files and saved them in the <code>programs/</code> folder.
You can do this with <code><a href="https://rdrr.io/pkg/knitr/man/knit.html">knitr::purl()</a></code>:</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_path</span> <span class="op">&lt;-</span> <span class="st">"esubdemo/vignettes/"</span></span>
<span><span class="va">output_path</span> <span class="op">&lt;-</span> <span class="st">"ectddemo/m5/datasets/ectddemo/analysis/adam/programs/"</span></span>
<span></span>
<span><span class="va">convert_rmd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span>, <span class="va">input_dir</span>, <span class="va">output_dir</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/knit.html">purl</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">input_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">filename</span>, <span class="st">".Rmd"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">filename</span>, <span class="st">".txt"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="st">"tlf-01-disposition"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">convert_rmd</span><span class="op">(</span><span class="va">input_path</span>, <span class="va">output_path</span><span class="op">)</span></span>
<span><span class="st">"tlf-02-population"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">convert_rmd</span><span class="op">(</span><span class="va">input_path</span>, <span class="va">output_path</span><span class="op">)</span></span>
<span><span class="st">"tlf-03-baseline"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">convert_rmd</span><span class="op">(</span><span class="va">input_path</span>, <span class="va">output_path</span><span class="op">)</span></span>
<span><span class="st">"tlf-04-efficacy"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">convert_rmd</span><span class="op">(</span><span class="va">input_path</span>, <span class="va">output_path</span><span class="op">)</span></span>
<span><span class="st">"tlf-05-ae-summary"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">convert_rmd</span><span class="op">(</span><span class="va">input_path</span>, <span class="va">output_path</span><span class="op">)</span></span>
<span><span class="st">"tlf-06-ae-spec"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">convert_rmd</span><span class="op">(</span><span class="va">input_path</span>, <span class="va">output_path</span><span class="op">)</span></span></code></pre></div>
<p>Optionally, you can add a header to the individual <code>.txt</code> files to explain
the context and help the reviewers rerun the code. For example:</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note to Reviewer</span></span>
<span><span class="co"># To rerun the code below, please refer to the ADRG appendix.</span></span>
<span><span class="co"># After the required packages are installed,</span></span>
<span><span class="co"># the path variable needs to be defined by using the example code below.</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># path = list(adam = "/path/to/esub/analysis/adam/datasets") # Modify to use actual location</span></span>
<span><span class="co"># path$outtable = path$outgraph = "." # Outputs saved to the current folder</span></span></code></pre></div>
<p>To automate this process:</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">header</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/textconnections.html">textConnection</a></span><span class="op">(</span><span class="st">"# Note to Reviewer</span></span>
<span><span class="st"># To rerun the code below, please refer to the ADRG appendix.</span></span>
<span><span class="st"># After the required packages are installed,</span></span>
<span><span class="st"># the path variable needs to be defined by using the example code below.</span></span>
<span><span class="st">#</span></span>
<span><span class="st"># path = list(adam = \"/path/to/esub/analysis/adam/datasets\") # Modify to use actual location</span></span>
<span><span class="st"># path$outtable = path$outgraph = \".\" # Outputs saved to the current folder"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">append_header</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span>, <span class="va">output_dir</span>, <span class="va">header</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">output_dir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">filename</span>, <span class="st">".txt"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">header</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span><span class="op">(</span><span class="va">y</span>, con <span class="op">=</span> <span class="va">file</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="st">"tlf-01-disposition"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">append_header</span><span class="op">(</span><span class="va">output_path</span>, <span class="va">header</span><span class="op">)</span></span>
<span><span class="st">"tlf-02-population"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">append_header</span><span class="op">(</span><span class="va">output_path</span>, <span class="va">header</span><span class="op">)</span></span>
<span><span class="st">"tlf-03-baseline"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">append_header</span><span class="op">(</span><span class="va">output_path</span>, <span class="va">header</span><span class="op">)</span></span>
<span><span class="st">"tlf-04-efficacy"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">append_header</span><span class="op">(</span><span class="va">output_path</span>, <span class="va">header</span><span class="op">)</span></span>
<span><span class="st">"tlf-05-ae-summary"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">append_header</span><span class="op">(</span><span class="va">output_path</span>, <span class="va">header</span><span class="op">)</span></span>
<span><span class="st">"tlf-06-ae-spec"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">append_header</span><span class="op">(</span><span class="va">output_path</span>, <span class="va">header</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="update-adrg" class="section level2" number="14.6">
<h2>
<span class="header-section-number">14.6</span> Update ADRG<a class="anchor" aria-label="anchor" href="#update-adrg"><i class="fas fa-link"></i></a>
</h2>
<p>After we converted the R packages and R Markdown files into the appropriate
formats and verified that they can be restored and executed correctly,
we need update the ADRG to provide guidelines on how to use them.</p>
<p>Specifically, we need to update two sections in ADRG.</p>
<p>The first section is “Macro Programs”, where R and R package versions
with a snapshot date are provided. For example:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb145-1"><a href="submission-package.html#cb145-1" aria-hidden="true" tabindex="-1"></a>7.x Macro Programs</span>
<span id="cb145-2"><a href="submission-package.html#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="submission-package.html#cb145-3" aria-hidden="true" tabindex="-1"></a>Submitted R programs have <span class="co">[</span><span class="ot">specific patterns</span><span class="co">]</span> in filenames.</span>
<span id="cb145-4"><a href="submission-package.html#cb145-4" aria-hidden="true" tabindex="-1"></a>All internally developed R functions are saved in the r0pkgs.txt file.</span>
<span id="cb145-5"><a href="submission-package.html#cb145-5" aria-hidden="true" tabindex="-1"></a>The recommended steps to unpack these R functions for analysis output</span>
<span id="cb145-6"><a href="submission-package.html#cb145-6" aria-hidden="true" tabindex="-1"></a>programs are described in the Appendix.</span>
<span id="cb145-7"><a href="submission-package.html#cb145-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-8"><a href="submission-package.html#cb145-8" aria-hidden="true" tabindex="-1"></a>The tables below contain the software version and instructions</span>
<span id="cb145-9"><a href="submission-package.html#cb145-9" aria-hidden="true" tabindex="-1"></a>for executing the R analysis output programs:</span></code></pre></div>
<div class="inline-table"><table class=" lightable-classic" style="font-size: 18px; font-family: 'Times New Roman', Times, serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Program Name
</th>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Output Table
</th>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Title
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
tlf-01-disposition.txt
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
Table x.y.z
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
Disposition of Patients
</td>
</tr>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
tlf-02-population.txt
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
Table x.y.z
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
Participants Accounting in Analysis Population (All Participants Randomized)
</td>
</tr>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
tlf-03-baseline.txt
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
Table x.y.z
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
Participant Baseline Characteristics (All Participants Randomized)
</td>
</tr>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
tlf-04-efficacy.txt
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
Table x.y.z
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
ANCOVA of Change from Baseline Glucose (mmol/L) at Week 24 <br> LOCF <br> Efficacy Analysis Population
</td>
</tr>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
tlf-05-ae-summary.txt
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
Table x.y.z
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
Analysis of Adverse Event Summary (Safety Analysis Population)
</td>
</tr>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
tlf-06-ae-spec.txt
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
Table x.y.z
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
Analysis of Participants With Specific Adverse Events (Safety Analysis Population)
</td>
</tr>
</tbody>
</table></div>
<div class="inline-table"><table class=" lightable-classic" style="font-size: 18px; font-family: 'Times New Roman', Times, serif; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead><tr>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Open-Source R Analysis Package
</th>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Package Version
</th>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Analysis Package Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
pkglite
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
0.2.0
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
Prepare submission package
</td>
</tr>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
haven
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
2.4.3
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
Read SAS datasets
</td>
</tr>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
dplyr
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
1.0.7
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
Manipulate datasets
</td>
</tr>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
tidyr
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
1.1.3
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
Manipulate datasets
</td>
</tr>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
emmeans
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
1.6.2-1
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
Least-squares means estimation
</td>
</tr>
<tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
r2rtf
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
0.3.0
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
Create RTF tables
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> R package versions based on CRAN on 2021-08-06
</td>
</tr></tfoot>
</table></div>
<div class="inline-table"><table class=" lightable-classic" style="font-size: 18px; font-family: 'Times New Roman', Times, serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Proprietary R Analysis Package
</th>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Package Version
</th>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Analysis Package Description
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;width: 18rem; border: 1px solid #000; text-align: center;">
esubdemo
</td>
<td style="text-align:left;width: 16rem; border: 1px solid #000; text-align: center;">
0.1.0
</td>
<td style="text-align:left;width: 28rem; border: 1px solid #000;">
A demo package for analysis and reporting of clinical trials
</td>
</tr></tbody>
</table></div>
<p>The second section (Appendix) should include step-by-step instructions
to reproduce the running environment and rerun analyses. For example:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb146-1"><a href="submission-package.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="an">Appendix:</span><span class="co"> Instructions to Execute Analysis Program in R</span></span>
<span id="cb146-2"><a href="submission-package.html#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="submission-package.html#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Install R</span>
<span id="cb146-4"><a href="submission-package.html#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="submission-package.html#cb146-5" aria-hidden="true" tabindex="-1"></a>Download and install R 4.1.1 for Windows from</span>
<span id="cb146-6"><a href="submission-package.html#cb146-6" aria-hidden="true" tabindex="-1"></a>https://cran.r-project.org/bin/windows/base/old/4.1.1/R-4.1.1-win.exe</span>
<span id="cb146-7"><a href="submission-package.html#cb146-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-8"><a href="submission-package.html#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Define working directory</span>
<span id="cb146-9"><a href="submission-package.html#cb146-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-10"><a href="submission-package.html#cb146-10" aria-hidden="true" tabindex="-1"></a>Create a temporary working directory, for example, "C:\tempwork".</span>
<span id="cb146-11"><a href="submission-package.html#cb146-11" aria-hidden="true" tabindex="-1"></a>Copy all submitted R programs into the temporary folder.</span>
<span id="cb146-12"><a href="submission-package.html#cb146-12" aria-hidden="true" tabindex="-1"></a>All steps below should be executed in this working directory</span>
<span id="cb146-13"><a href="submission-package.html#cb146-13" aria-hidden="true" tabindex="-1"></a>represented as "." in the example R code below.</span>
<span id="cb146-14"><a href="submission-package.html#cb146-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-15"><a href="submission-package.html#cb146-15" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Specify R package repository</span>
<span id="cb146-16"><a href="submission-package.html#cb146-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-17"><a href="submission-package.html#cb146-17" aria-hidden="true" tabindex="-1"></a>The R packages are based on CRAN at 2021-08-06. To install the exact</span>
<span id="cb146-18"><a href="submission-package.html#cb146-18" aria-hidden="true" tabindex="-1"></a>R package versions used in this project, run the code below to set</span>
<span id="cb146-19"><a href="submission-package.html#cb146-19" aria-hidden="true" tabindex="-1"></a>the snapshot repository.</span>
<span id="cb146-20"><a href="submission-package.html#cb146-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-21"><a href="submission-package.html#cb146-21" aria-hidden="true" tabindex="-1"></a>options(repos = "https://mran.microsoft.com/snapshot/2021-08-06/")</span>
<span id="cb146-22"><a href="submission-package.html#cb146-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-23"><a href="submission-package.html#cb146-23" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Install open-source R packages</span>
<span id="cb146-24"><a href="submission-package.html#cb146-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-25"><a href="submission-package.html#cb146-25" aria-hidden="true" tabindex="-1"></a>In the same R session, install the required packages by running the code below.</span>
<span id="cb146-26"><a href="submission-package.html#cb146-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-27"><a href="submission-package.html#cb146-27" aria-hidden="true" tabindex="-1"></a>install.packages(c("pkglite", "publicpkg1", "publicpkg2"))</span>
<span id="cb146-28"><a href="submission-package.html#cb146-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-29"><a href="submission-package.html#cb146-29" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Install proprietary R packages</span>
<span id="cb146-30"><a href="submission-package.html#cb146-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-31"><a href="submission-package.html#cb146-31" aria-hidden="true" tabindex="-1"></a>All internal R packages are packed in the file r0pkgs.txt. In the same R session,</span>
<span id="cb146-32"><a href="submission-package.html#cb146-32" aria-hidden="true" tabindex="-1"></a>restore the package structures and install them by running the code below.</span>
<span id="cb146-33"><a href="submission-package.html#cb146-33" aria-hidden="true" tabindex="-1"></a>Adjust the output path as needed to use a writable local directory.</span>
<span id="cb146-34"><a href="submission-package.html#cb146-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-35"><a href="submission-package.html#cb146-35" aria-hidden="true" tabindex="-1"></a>pkglite::unpack("r0pkgs.txt", output = ".", install = TRUE)</span>
<span id="cb146-36"><a href="submission-package.html#cb146-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-37"><a href="submission-package.html#cb146-37" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Update path to dataset and TLFs</span>
<span id="cb146-38"><a href="submission-package.html#cb146-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-39"><a href="submission-package.html#cb146-39" aria-hidden="true" tabindex="-1"></a>INPUT path: to rerun the analysis programs, define the path variable</span>
<span id="cb146-40"><a href="submission-package.html#cb146-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-41"><a href="submission-package.html#cb146-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Path for ADaM data: path$adam</span>
<span id="cb146-42"><a href="submission-package.html#cb146-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-43"><a href="submission-package.html#cb146-43" aria-hidden="true" tabindex="-1"></a>OUTPUT path: to save the analysis results, define the path variable</span>
<span id="cb146-44"><a href="submission-package.html#cb146-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-45"><a href="submission-package.html#cb146-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Path for output TLFs: path$output</span>
<span id="cb146-46"><a href="submission-package.html#cb146-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-47"><a href="submission-package.html#cb146-47" aria-hidden="true" tabindex="-1"></a>All these paths need to be defined before executing the analysis program. For example:</span>
<span id="cb146-48"><a href="submission-package.html#cb146-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-49"><a href="submission-package.html#cb146-49" aria-hidden="true" tabindex="-1"></a>path = list(adam = "/path/to/esub/analysis/adam/datasets/") # Modify to use actual location</span>
<span id="cb146-50"><a href="submission-package.html#cb146-50" aria-hidden="true" tabindex="-1"></a>path$outtable = path$outgraph = "." # Outputs saved to the current folder</span>
<span id="cb146-51"><a href="submission-package.html#cb146-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-52"><a href="submission-package.html#cb146-52" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Execute analysis program</span>
<span id="cb146-53"><a href="submission-package.html#cb146-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-54"><a href="submission-package.html#cb146-54" aria-hidden="true" tabindex="-1"></a>To reproduce the analysis results, rerun the following programs:</span>
<span id="cb146-55"><a href="submission-package.html#cb146-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-56"><a href="submission-package.html#cb146-56" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>tlf-01-disposition.txt</span>
<span id="cb146-57"><a href="submission-package.html#cb146-57" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>tlf-02-population.txt</span>
<span id="cb146-58"><a href="submission-package.html#cb146-58" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>tlf-03-baseline.txt</span>
<span id="cb146-59"><a href="submission-package.html#cb146-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>tlf-04-efficacy.txt</span>
<span id="cb146-60"><a href="submission-package.html#cb146-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>tlf-05-ae-summary.txt</span>
<span id="cb146-61"><a href="submission-package.html#cb146-61" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>tlf-06-ae-spec.txt</span></code></pre></div>
<p>An example ADRG following this template can be found in
<a href="https://github.com/elong0527/ectddemo/blob/master/m5/datasets/ectddemo/analysis/adam/datasets/adrg.pdf">ectddemo</a>.</p>
</div>
<div id="update-arm" class="section level2" number="14.7">
<h2>
<span class="header-section-number">14.7</span> Update ARM<a class="anchor" aria-label="anchor" href="#update-arm"><i class="fas fa-link"></i></a>
</h2>
<p>The ARM (Analysis Results Metadata) should provide specific information
related to R in two sections:</p>
<ul>
<li>Section 2: indicate the <strong>Programming Language</strong>;</li>
<li>Section 3: document the details of the R programs listed in section 3.</li>
</ul>
<p>For example, in ARM section 2, “Analysis Results Metadata Summary”:</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/output_type.html">is_latex_output</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df4</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">kbl</span><span class="op">(</span>format <span class="op">=</span> <span class="st">"latex"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/output_type.html">is_html_output</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df4</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">kbl</span><span class="op">(</span>format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">kable_classic</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span>, html_font <span class="op">=</span> <span class="st">"'Times New Roman', Times, serif"</span>, font_size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">column_spec</span><span class="op">(</span><span class="fl">1</span>, extra_css <span class="op">=</span> <span class="st">"border: 1px solid #000; text-align: center;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">column_spec</span><span class="op">(</span><span class="fl">2</span>, extra_css <span class="op">=</span> <span class="st">"border: 1px solid #000; text-align: center;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">column_spec</span><span class="op">(</span><span class="fl">3</span>, extra_css <span class="op">=</span> <span class="st">"border: 1px solid #000; text-align: center;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">column_spec</span><span class="op">(</span><span class="fl">4</span>, extra_css <span class="op">=</span> <span class="st">"border: 1px solid #000; text-align: center;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">column_spec</span><span class="op">(</span><span class="fl">5</span>, extra_css <span class="op">=</span> <span class="st">"border: 1px solid #000; text-align: center;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, background <span class="op">=</span> <span class="st">"#DFDFDF"</span>, bold <span class="op">=</span> <span class="cn">TRUE</span>, extra_css <span class="op">=</span> <span class="st">"border: 1px solid #000; text-align: center;"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="inline-table"><table class=" lightable-classic" style="font-size: 18px; font-family: 'Times New Roman', Times, serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Table Reference
</th>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Table Title
</th>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Programming Language
</th>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Program Name (programs)
</th>
<th style="text-align:left;font-weight: bold;background-color: #DFDFDF !important;border: 1px solid #000; text-align: center;">
Input File Name / Analysis (datasets)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;border: 1px solid #000; text-align: center;">
[Ref. x.y.z: P001ZZZ9999: Table 1-1]
</td>
<td style="text-align:left;border: 1px solid #000; text-align: center;">
Disposition of Patients
</td>
<td style="text-align:left;border: 1px solid #000; text-align: center;">
R
</td>
<td style="text-align:left;border: 1px solid #000; text-align: center;">
tlf-01-disposition.txt
</td>
<td style="text-align:left;border: 1px solid #000; text-align: center;">
adsl.xpt
</td>
</tr>
<tr>
<td style="text-align:left;border: 1px solid #000; text-align: center;">
…
</td>
<td style="text-align:left;border: 1px solid #000; text-align: center;">
…
</td>
<td style="text-align:left;border: 1px solid #000; text-align: center;">
…
</td>
<td style="text-align:left;border: 1px solid #000; text-align: center;">
…
</td>
<td style="text-align:left;border: 1px solid #000; text-align: center;">
…
</td>
</tr>
</tbody>
</table></div>
<p>In ARM section 3, “Analysis Results Metadata Details”:</p>
<div class="inline-table"><table class=" lightable-classic" style="font-size: 18px; font-family: 'Times New Roman', Times, serif; width: auto !important; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;font-weight: bold;border: 1px solid #000;">
Table Reference: [Ref. x.y.z: P001ZZZ9999: Table 1-1]
</td>
<td style="text-align:left;border: 1px solid #000;">
…
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border: 1px solid #000;">
Analysis Result
</td>
<td style="text-align:left;border: 1px solid #000;">
…
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border: 1px solid #000;">
Analysis Parameters (s)
</td>
<td style="text-align:left;border: 1px solid #000;">
…
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border: 1px solid #000;">
Analysis Reason
</td>
<td style="text-align:left;border: 1px solid #000;">
…
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border: 1px solid #000;">
Analysis Purpose
</td>
<td style="text-align:left;border: 1px solid #000;">
…
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border: 1px solid #000;">
…
</td>
<td style="text-align:left;border: 1px solid #000;">
…
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border: 1px solid #000;">
Programming Statements
</td>
<td style="text-align:left;border: 1px solid #000;">
(R version 4.1.1), [P001ZZZ9999: programs-tlf-01-disposition]
</td>
</tr>
</tbody></table></div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="submission-overview.html"><span class="header-section-number">13</span> Overview</a></div>
<div class="next"><a href="running-environment.html"><span class="header-section-number">15</span> Running environment</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#submission-package"><span class="header-section-number">14</span> Submission package</a></li>
<li><a class="nav-link" href="#prerequisites"><span class="header-section-number">14.1</span> Prerequisites</a></li>
<li>
<a class="nav-link" href="#the-whole-game"><span class="header-section-number">14.2</span> The whole game</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#datasets-1"><span class="header-section-number">14.2.1</span> datasets</a></li>
<li><a class="nav-link" href="#programs"><span class="header-section-number">14.2.2</span> programs</a></li>
<li><a class="nav-link" href="#notes"><span class="header-section-number">14.2.3</span> Notes</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#practical-considerations-for-r-package-submissions"><span class="header-section-number">14.3</span> Practical considerations for R package submissions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#source-location"><span class="header-section-number">14.3.1</span> Source location</a></li>
<li><a class="nav-link" href="#dependency-locations"><span class="header-section-number">14.3.2</span> Dependency locations</a></li>
<li><a class="nav-link" href="#r-version-1"><span class="header-section-number">14.3.3</span> R version</a></li>
<li><a class="nav-link" href="#package-repo-version"><span class="header-section-number">14.3.4</span> Package repo version</a></li>
<li><a class="nav-link" href="#system-environments"><span class="header-section-number">14.3.5</span> System environments</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#prepare-r-packages-for-submission"><span class="header-section-number">14.4</span> Prepare R packages for submission</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pack"><span class="header-section-number">14.4.1</span> Pack</a></li>
<li><a class="nav-link" href="#verify"><span class="header-section-number">14.4.2</span> Verify</a></li>
<li><a class="nav-link" href="#unpack"><span class="header-section-number">14.4.3</span> Unpack</a></li>
</ul>
</li>
<li><a class="nav-link" href="#prepare-analysis-programs-for-submission"><span class="header-section-number">14.5</span> Prepare analysis programs for submission</a></li>
<li><a class="nav-link" href="#update-adrg"><span class="header-section-number">14.6</span> Update ADRG</a></li>
<li><a class="nav-link" href="#update-arm"><span class="header-section-number">14.7</span> Update ARM</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/elong0527/r4csr/blob/master/submission-package.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/elong0527/r4csr/edit/master/submission-package.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Clinical Study Reports and Submission</strong>" was written by Yilong Zhang, Nan Xiao, Keaven Anderson. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
